# -*- coding: utf-8 -*-
"""SQL task

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1eFu12rrLVGqKOj5bLSysFeTLpN55pne0

Create a SQLite database
"""

import sqlite3

# Create database in memory
conn = sqlite3.connect(':memory:')
cursor = conn.cursor()

"""Create a table"""

cursor.execute("""
CREATE TABLE students(
    id INTEGER PRIMARY KEY,
    name TEXT,
    score INTEGER
)
""")
conn.commit()

"""Insert data"""

cursor.execute("INSERT INTO students VALUES (1, 'Aisha', 85)")
cursor.execute("INSERT INTO students VALUES (2, 'Rahul', 92)")
cursor.execute("INSERT INTO students VALUES (3, 'Meera', 76)")
conn.commit()

"""Run SQL Queries"""

# Select all data
cursor.execute("SELECT * FROM students")
cursor.fetchall()

# WHERE condition
cursor.execute("SELECT * FROM students WHERE score > 80")
cursor.fetchall()

#ORDER BY
cursor.execute("SELECT * FROM students ORDER BY score DESC")
cursor.fetchall()

#UPDATE
cursor.execute("UPDATE students SET score = 95 WHERE id = 2")
conn.commit()

#DELETE
cursor.execute("DELETE FROM students WHERE id = 3")
conn.commit()

"""Use Pandas to view SQL result nicely"""

import pandas as pd

df = pd.read_sql_query("SELECT * FROM students", conn)
df